<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="referrer" content="never"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Spring Boot之logback日志最佳实践 | calebzhao的博客</title><meta name="description" content="Spring Boot之logback日志最佳实践"><meta name="author" content="calebzhao"><meta name="copyright" content="calebzhao"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/calebzhao/cdn/img/20191229155709.png"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Spring Boot之logback日志最佳实践"><meta name="twitter:description" content="Spring Boot之logback日志最佳实践"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta property="og:type" content="article"><meta property="og:title" content="Spring Boot之logback日志最佳实践"><meta property="og:url" content="https://calebzhao.github.io/2020/01/10/Spring%20Boot%E4%B9%8Blogback%E6%97%A5%E5%BF%97%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"><meta property="og:site_name" content="calebzhao的博客"><meta property="og:description" content="Spring Boot之logback日志最佳实践"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://calebzhao.github.io/2020/01/10/Spring%20Boot%E4%B9%8Blogback%E6%97%A5%E5%BF%97%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"><link rel="next" title="power designer日常使用" href="https://calebzhao.github.io/2020/01/09/power%20designer%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.5/dist/instantsearch.min.js" defer></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"EU39VTKAPM","apiKey":"9108b7c9e302dddcc64205e00d26f470","indexName":"hexo","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://calebzhao.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">calebzhao的博客</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">20</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">16</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#惊讶！我定的日志规范被CTO在全公司推广了"><span class="toc_mobile_items-text">惊讶！我定的日志规范被CTO在全公司推广了</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#1-日志"><span class="toc_mobile_items-text">1. 日志</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-1-日志是什么？"><span class="toc_mobile_items-text">1.1 日志是什么？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-2-日志有什么用？"><span class="toc_mobile_items-text">1.2 日志有什么用？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-3-什么时候记录日志？"><span class="toc_mobile_items-text">1.3 什么时候记录日志？</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#2-日志打印"><span class="toc_mobile_items-text">2. 日志打印</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-1-Slf4j-amp-Logback"><span class="toc_mobile_items-text">2.1 Slf4j &amp; Logback</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-2-日志文件"><span class="toc_mobile_items-text">2.2 日志文件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-3-日志变量定义"><span class="toc_mobile_items-text">2.3 日志变量定义</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-4-日志配置"><span class="toc_mobile_items-text">2.4 日志配置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-5-参数占位格式"><span class="toc_mobile_items-text">2.5 参数占位格式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-1-日志时间"><span class="toc_mobile_items-text">2.6.1 日志时间</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-2-日志级别"><span class="toc_mobile_items-text">2.6.2 日志级别</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-6-线程名称"><span class="toc_mobile_items-text">2.6.6 线程名称</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-7-opentracing-标识"><span class="toc_mobile_items-text">2.6.7 opentracing 标识</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-8-biz-标识"><span class="toc_mobile_items-text">2.6.8 biz 标识</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-9-日志记录器名称"><span class="toc_mobile_items-text">2.6.9 日志记录器名称</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-10-日志内容"><span class="toc_mobile_items-text">2.6.10 日志内容</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-6-11-异常堆栈"><span class="toc_mobile_items-text">2.6.11 异常堆栈</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-7-最佳实践"><span class="toc_mobile_items-text">2.7 最佳实践</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-7-1-日志格式"><span class="toc_mobile_items-text">2.7.1 日志格式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-7-2-日志模块扩展"><span class="toc_mobile_items-text">2.7.2 日志模块扩展</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-1-SLS-阿里云日志服务"><span class="toc_mobile_items-text">3.1 SLS 阿里云日志服务</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#project"><span class="toc_mobile_items-text">project</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#logstore"><span class="toc_mobile_items-text">logstore</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#实时采集与消费"><span class="toc_mobile_items-text">实时采集与消费</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查询分析"><span class="toc_mobile_items-text">查询分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#消费投递"><span class="toc_mobile_items-text">消费投递</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#告警"><span class="toc_mobile_items-text">告警</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#最佳实践"><span class="toc_mobile_items-text">最佳实践</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-2-ELK-通用日志解决方案"><span class="toc_mobile_items-text">3.2 ELK 通用日志解决方案</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#4-实践说明"><span class="toc_mobile_items-text">4 实践说明</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#普通格式日志"><span class="toc_mobile_items-text">普通格式日志</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#特定格式日志"><span class="toc_mobile_items-text">特定格式日志</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#引入相关maven坐标"><span class="toc_mobile_items-text">引入相关maven坐标</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#配置参考"><span class="toc_mobile_items-text">配置参考</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#参考文献"><span class="toc_mobile_items-text">参考文献</span></a></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#惊讶！我定的日志规范被CTO在全公司推广了"><span class="toc-text">惊讶！我定的日志规范被CTO在全公司推广了</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-日志"><span class="toc-text">1. 日志</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-日志是什么？"><span class="toc-text">1.1 日志是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-日志有什么用？"><span class="toc-text">1.2 日志有什么用？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-什么时候记录日志？"><span class="toc-text">1.3 什么时候记录日志？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-日志打印"><span class="toc-text">2. 日志打印</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Slf4j-amp-Logback"><span class="toc-text">2.1 Slf4j &amp; Logback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-日志文件"><span class="toc-text">2.2 日志文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-日志变量定义"><span class="toc-text">2.3 日志变量定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-日志配置"><span class="toc-text">2.4 日志配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-参数占位格式"><span class="toc-text">2.5 参数占位格式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-1-日志时间"><span class="toc-text">2.6.1 日志时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-2-日志级别"><span class="toc-text">2.6.2 日志级别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-6-线程名称"><span class="toc-text">2.6.6 线程名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-7-opentracing-标识"><span class="toc-text">2.6.7 opentracing 标识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-8-biz-标识"><span class="toc-text">2.6.8 biz 标识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-9-日志记录器名称"><span class="toc-text">2.6.9 日志记录器名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-10-日志内容"><span class="toc-text">2.6.10 日志内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-11-异常堆栈"><span class="toc-text">2.6.11 异常堆栈</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-最佳实践"><span class="toc-text">2.7 最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-1-日志格式"><span class="toc-text">2.7.1 日志格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2-日志模块扩展"><span class="toc-text">2.7.2 日志模块扩展</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-SLS-阿里云日志服务"><span class="toc-text">3.1 SLS 阿里云日志服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#project"><span class="toc-text">project</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#logstore"><span class="toc-text">logstore</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#实时采集与消费"><span class="toc-text">实时采集与消费</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查询分析"><span class="toc-text">查询分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#消费投递"><span class="toc-text">消费投递</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#告警"><span class="toc-text">告警</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最佳实践"><span class="toc-text">最佳实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-ELK-通用日志解决方案"><span class="toc-text">3.2 ELK 通用日志解决方案</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-实践说明"><span class="toc-text">4 实践说明</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#普通格式日志"><span class="toc-text">普通格式日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#特定格式日志"><span class="toc-text">特定格式日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#引入相关maven坐标"><span class="toc-text">引入相关maven坐标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#配置参考"><span class="toc-text">配置参考</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考文献"><span class="toc-text">参考文献</span></a></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png)"><div id="post-info"><div id="post-title"><div class="posttitle">Spring Boot之logback日志最佳实践</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-01-10<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-01-10</time><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4.5k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 15 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/2020/01/10/Spring%20Boot%E4%B9%8Blogback%E6%97%A5%E5%BF%97%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/01/10/Spring%20Boot%E4%B9%8Blogback%E6%97%A5%E5%BF%97%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><html><head></head><body><h2 id="惊讶！我定的日志规范被CTO在全公司推广了"><a href="#惊讶！我定的日志规范被CTO在全公司推广了" class="headerlink" title="惊讶！我定的日志规范被CTO在全公司推广了"></a>惊讶！我定的日志规范被CTO在全公司推广了</h2><blockquote>
<p>打印日志是一门艺术，但长期被开发同学所忽视。日志就像车辆保险，没人愿意为保险付钱，但是一旦出了问题都又想有保险可用。我们打印日志的时候都很随意，可是用的时候会吐槽各种 SB 包括自己！写好每一条日志吧，与君共勉！</p>
</blockquote>
<h1 id="1-日志"><a href="#1-日志" class="headerlink" title="1. 日志"></a><strong>1. 日志</strong></h1><h2 id="1-1-日志是什么？"><a href="#1-1-日志是什么？" class="headerlink" title="1.1 日志是什么？"></a><strong>1.1 日志是什么？</strong></h2><p>日志，维基百科的定义是记录服务器等电脑设备或软件的运作。</p>
<p>日志文件提供精确的系统记录，根据日志最终定位到错误详情和根源。日志的特点是，它描述一些离散的（不连续的）事件。例如：应用通过一个滚动的文件输出 INFO 或 ERROR 信息，并通过日志收集系统，存储到一些存储引擎（Elasticsearch）中方便查询。</p>
<h2 id="1-2-日志有什么用？"><a href="#1-2-日志有什么用？" class="headerlink" title="1.2 日志有什么用？"></a><strong>1.2 日志有什么用？</strong></h2><p>在上文中我们解释了日志的作用是提供精准的系统记录方便根因分析。那么具体在哪些具体方面它可以发挥作用？</p>
<ul>
<li><strong>打印调试</strong>：即可以用日志来记录变量或者某一段逻辑。记录程序运行的流程，即程序运行了哪些代码，方便排查逻辑问题。</li>
<li><strong>问题定位</strong>：程序出异常或者出故障时快速的定位问题，方便后期解决问题。因为线上生产环境无法 debug，在测试环境去模拟一套生产环境，费时费力。所以依靠日志记录的信息定位问题，这点非常重要。还可以记录流量，后期可以通过 ELK（包括 EFK 进行流量统计）。</li>
<li><strong>用户行为日志</strong>：记录用户的操作行为，用于大数据分析，比如监控、风控、推荐等等。这种日志，一般是给其他团队分析使用，而且可能是多个团队，因此一般会有一定的格式要求，开发者应该按照这个格式来记录，便于其他团队的使用。当然，要记录哪些行为、操作，一般也是约定好的，因此，开发者主要是执行的角色。</li>
<li><strong>根因分析（**</strong>甩锅必备<strong>**）</strong>：即在关键地方记录日志。方便在和各个终端定位问题时，别人说时你的程序问题，你可以理直气壮的拿出你的日志说，看，我这里运行了，状态也是对的。这样，对方就会乖乖去定位他的代码，而不是互相推脱。</li>
</ul>
<h2 id="1-3-什么时候记录日志？"><a href="#1-3-什么时候记录日志？" class="headerlink" title="1.3 什么时候记录日志？"></a><strong>1.3 什么时候记录日志？</strong></h2><p>上文说了日志的重要性，那么什么时候需要记录日志。</p>
<ul>
<li><strong>系统初始化</strong>：系统或者服务的启动参数。核心模块或者组件初始化过程中往往依赖一些关键配置，根据参数不同会提供不一样的服务。务必在这里记录 INFO 日志，打印出参数以及启动完成态服务表述。</li>
<li><strong>编程语言提示异常</strong>：如今各类主流的编程语言都包括异常机制，业务相关的流行框架有完整的异常模块。这类捕获的异常是系统告知开发人员需要加以关注的，是质量非常高的报错。应当适当记录日志，根据实际结合业务的情况使用 WARN 或者 ERROR 级别。</li>
<li><strong>业务流程预期不符</strong>：除开平台以及编程语言异常之外，项目代码中结果与期望不符时也是日志场景之一，简单来说所有流程分支都可以加入考虑。取决于开发人员判断能否容忍情形发生。常见的合适场景包括外部参数不正确，数据处理问题导致返回码不在合理范围内等等。</li>
<li><strong>系统核心角色，组件关键动作</strong>：系统中核心角色触发的业务动作是需要多加关注的，是衡量系统正常运行的重要指标，建议记录 INFO 级别日志，比如电商系统用户从登录到下单的整个流程；微服务各服务节点交互；核心数据表增删改；核心组件运行等等，如果日志频度高或者打印量特别大，可以提炼关键点 INFO 记录，其余酌情考虑 DEBUG 级别。</li>
<li><strong>第三方服务远程调用</strong>：微服务架构体系中有一个重要的点就是第三方永远不可信，对于第三方服务远程调用建议打印请求和响应的参数，方便在和各个终端定位问题，不会因为第三方服务日志的缺失变得手足无措。</li>
</ul>
<h1 id="2-日志打印"><a href="#2-日志打印" class="headerlink" title="2. 日志打印"></a><strong>2. 日志打印</strong></h1><h2 id="2-1-Slf4j-amp-Logback"><a href="#2-1-Slf4j-amp-Logback" class="headerlink" title="2.1 Slf4j & Logback"></a><strong>2.1 Slf4j & Logback</strong></h2><p>Slf4j 英文全称为 “ Simple Logging Facade for Java ”，为 Java 提供的简单日志门面。Facade 门面，更底层一点说就是接口。它允许用户以自己的喜好，在工程中通过 Slf4j 接入不同的日志系统。</p>
<p>Logback 是 Slf4j 的原生实现框架，同样也是出自 Log4j 一个人之手，但拥有比 Log4j 更多的优点、特性和更做强的性能，Logback 相对于 Log4j 拥有更快的执行速度。基于我们先前在 Log4j  上的工作，Logback 重写了内部的实现，在某些特定的场景上面，甚至可以比之前的速度快上 10 倍。在保证 Logback 的组件更加快速的同时，同时所需的内存更加少。</p>
<h2 id="2-2-日志文件"><a href="#2-2-日志文件" class="headerlink" title="2.2 日志文件"></a><strong>2.2 日志文件</strong></h2><p>日志文件放置于固定的目录中，按照一定的模板进行命名，推荐的日志文件名称：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">当前正在写入的日志文件名：<应用名>[-<功能名>].log</span><br><span class="line">如：example-server-book-service-access.log</span><br><span class="line"></span><br><span class="line">已经滚入历史的日志文件名：<应用名>[-<功能名>].yyyy-MM-dd-hh.[滚动号].log</span><br><span class="line">如：example-server-book-service-access.2019-12-01-10.1.log</span><br></pre></td></tr></tbody></table></figure></div>

<h2 id="2-3-日志变量定义"><a href="#2-3-日志变量定义" class="headerlink" title="2.3 日志变量定义"></a><strong>2.3 日志变量定义</strong></h2><p>推荐使用 lombok（代码生成器） 注解 @lombok.extern.slf4j.Slf4j 来生成日志变量实例。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --></span><br><span class="line"><dependency></dependency></span><br><span class="line">    <groupid>org.projectlombok</groupid></span><br><span class="line">    <artifactid>lombok</artifactid></span><br><span class="line">    <version>1.18.10</version></span><br><span class="line">    <scope>provided</scope></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></div>

<p>代码示例</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line">@Slf4j</span><br><span class="line">public class LogTest {</span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        log.info("this is log test");</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>



<h2 id="2-4-日志配置"><a href="#2-4-日志配置" class="headerlink" title="2.4 日志配置"></a><strong>2.4 日志配置</strong></h2><p>日志记录采用分级记录，级别与日志文件名相对应，不同级别的日志信息记录到不同的日志文件中。如有特殊格式日志，如 access log，单独使用一个文件，请注意避免重复打印（可使用 <strong>additivity**</strong>=”false”**避免 ）。</p>
<h2 id="2-5-参数占位格式"><a href="#2-5-参数占位格式" class="headerlink" title="2.5 参数占位格式"></a><strong>2.5 参数占位格式</strong></h2><p>使用参数化形式 {} 占位，[] 进行参数隔离，这样的好处是可读性更高，而且只有真正准备打印的时候才会处理参数。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 正确示例，必须使用参数化信息的方式</span><br><span class="line">log.debug("order is paying with userId:[{}] and orderId : [{}]",userId, orderId);</span><br><span class="line">// 错误示例，不要进行字符串拼接,那样会产生很多 String 对象，占用空间，影响性能。及日志级别高于此级别也会进行字符串拼接逻辑。</span><br><span class="line">log.debug("order is paying with userId: " + userId + " and orderId: " + orderId);</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="2-6-1-日志时间"><a href="#2-6-1-日志时间" class="headerlink" title="2.6.1 日志时间"></a><strong>2.6.1 日志时间</strong></h3><p>作为日志产生的日期和时间，这个数据非常重要，一般精确到毫秒。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yyyy-MM-dd HH:mm:ss.SSS</span><br></pre></td></tr></tbody></table></figure></div>

<h3 id="2-6-2-日志级别"><a href="#2-6-2-日志级别" class="headerlink" title="2.6.2 日志级别"></a><strong>2.6.2 日志级别</strong></h3><p>日志的输出都是分级别的，不同的设置不同的场合打印不同的日志。</p>
<p>主要使用如下的四个级别：</p>
<ul>
<li>DEBUG：DEUBG 级别的主要输出调试性质的内容，该级别日志主要用于在开发、测试阶段输出。该级别的日志应尽可能地详尽，开发人员可以将各类详细信息记录到 DEBUG 里，起到调试的作用，包括参数信息，调试细节信息，返回值信息等等，便于在开发、测试阶段出现问题或者异常时，对其进行分析。</li>
<li>INFO：INFO 级别的主要记录系统关键信息，旨在保留系统正常工作期间关键运行指标，开发人员可以将初始化系统配置、业务状态变化信息，或者用户业务流程中的核心处理记录到INFO日志中，方便日常运维工作以及错误回溯时上下文场景复现。建议在项目完成后，在测试环境将日志级别调成 INFO，然后通过 INFO 级别的信息看看是否能了解这个应用的运用情况，如果出现问题后是否这些日志能否提供有用的排查问题的信息。</li>
<li>WARN：WARN 级别的主要输出警告性质的内容，这些内容是可以预知且是有规划的，比如，某个方法入参为空或者该参数的值不满足运行该方法的条件时。在 WARN 级别的时应输出较为详尽的信息，以便于事后对日志进行分析。</li>
<li>ERROR：ERROR 级别主要针对于一些不可预知的信息，诸如：错误、异常等，比如，在 catch 块中抓获的网络通信、数据库连接等异常，若异常对系统的整个流程影响不大，可以使用 WARN 级别日志输出。在输出 ERROR 级别的日志时，尽量多地输出方法入参数、方法执行过程中产生的对象等数据，在带有错误、异常对象的数据时，需要将该对象一并输出。</li>
</ul>
<p><strong>2.6.3 DEBUG / INFO 的选择</strong></p>
<p>DEBUG 级别比 INFO 低，包含调试时更详细的了解系统运行状态的东西，比如变量的值等等，都可以输出到 DEBUG 日志里。INFO 是在线日志默认的输出级别，反馈系统的当前状态给最终用户看的。输出的信息，应该对最终用户具有实际意义的。从功能角度上说，INFO 输出的信息可以看作是软件产品的一部分，所以需要谨慎对待，不可随便输出。如果这条日志会被频繁打印或者大部分时间对于纠错起不到作用，就应当考虑下调为 DEBUG 级别。</p>
<ul>
<li>由于 DEBUG 日志打印量远大于 INFO，出于前文日志性能的考虑，如果代码为核心代码，执行频率非常高，务必推敲日志设计是否合理，是否需要下调为 DEBUG 级别日志。</li>
<li>注意日志的可读性，不妨在写完代码 review 这条日志是否通顺，能否提供真正有意义的信息。</li>
<li>日志输出是多线程公用的，如果有另外一个线程正在输出日志，上面的记录就会被打断，最终显示输出和预想的就会不一致。</li>
</ul>
<p><strong>2.6.4 WARN / ERROR 的选择</strong></p>
<p>当方法或者功能处理过程中产生不符合预期结果或者有框架报错时可以考虑使用，常见问题处理方法包括：</p>
<ul>
<li>增加判断处理逻辑，尝试本地解决：增加逻辑判断吞掉报警永远是最优选择抛出异常，交给上层逻辑解决</li>
<li>抛出异常，交给上层逻辑解决</li>
<li>记录日志，报警提醒</li>
<li>使用返回码包装错误做返回</li>
</ul>
<p>一般来说，WARN 级别不会短信报警，ERROR 级别则会短信报警甚至电话报警，ERROR 级别的日志意味着系统中发生了非常严重的问题，必须有人马上处理，比如数据库不可用，系统的关键业务流程走不下去等等。错误的使用反而带来严重的后果，不区分问题的重要程度，只要有问题就error记录下来，其实这样是非常不负责任的，因为对于成熟的系统，都会有一套完整的报错机制，那这个错误信息什么时候需要发出来，很多都是依据单位时间内 ERROR 日志的数量来确定的。</p>
<p><strong>2.6.5 强调ERROR报警</strong></p>
<ul>
<li>ERROR 级别的日志打印通常伴随报警通知。ERROR的报出应该伴随着业务功能受损，即上面提到的系统中发生了非常严重的问题，必须有人马上处理。</li>
</ul>
<p>ERROR日志目标</p>
<ul>
<li>给处理者直接准确的信息：ERROR 信息形成自身闭环。</li>
</ul>
<p>问题定位：</p>
<ul>
<li>发生了什么问题，哪些功能受到影响</li>
<li>获取帮助信息：直接帮助信息或帮助信息的存储位置</li>
<li>通过报警知道解决方案或者找何人解决</li>
</ul>
<h3 id="2-6-6-线程名称"><a href="#2-6-6-线程名称" class="headerlink" title="2.6.6 线程名称"></a><strong>2.6.6 线程名称</strong></h3><p>输出该日志的线程名称，一般在一个应用中一个同步请求由同一线程完成，输出线程名称可以在各个请求产生的日志中进行分类，便于分清当前请求上下文的日志。</p>
<h3 id="2-6-7-opentracing-标识"><a href="#2-6-7-opentracing-标识" class="headerlink" title="2.6.7 opentracing 标识"></a><strong>2.6.7 opentracing 标识</strong></h3><p>在分布式应用中，用户的一个请求会调用若干个服务完成，这些服务可能还是嵌套调用的，因此完成一个请求的日志并不在一个应用的日志文件，而是分散在不同服务器上不同应用节点的日志文件中。该标识是为了串联一个请求在整个系统中的调用日志。</p>
<ul>
<li>唯一字符串（trace id）</li>
<li>调用层级（span id）</li>
</ul>
<p>通过搜索 trace id 就可以查到这个 trace id 标识的请求在整个系统中流转（处理）过程中产生的所有日志。</p>
<h3 id="2-6-8-biz-标识"><a href="#2-6-8-biz-标识" class="headerlink" title="2.6.8 biz 标识"></a><strong>2.6.8 biz 标识</strong></h3><p>在业务开发中，我们的日志都是和业务相关联的，有时候是需要根据用户或者业务做聚类的，因此一次请求如果可以通过某项标识做聚类的时候，可以将聚类标识打印到日志中。</p>
<ul>
<li>用户标识（user id）</li>
<li>业务标识（biz id）</li>
</ul>
<h3 id="2-6-9-日志记录器名称"><a href="#2-6-9-日志记录器名称" class="headerlink" title="2.6.9 日志记录器名称"></a><strong>2.6.9 日志记录器名称</strong></h3><p>日志记录器名称一般使用类名，日志文件中可以输出简单的类名即可，看实际情况是否需要使用包名和行号等信息。主要用于看到日志后到哪个类中去找这个日志输出，便于定位问题所在。</p>
<h3 id="2-6-10-日志内容"><a href="#2-6-10-日志内容" class="headerlink" title="2.6.10 日志内容"></a><strong>2.6.10 日志内容</strong></h3><p>禁用 System.out.println 和 System.err.println</p>
<p>变参替换日志拼接</p>
<p>输出日志的对象，应在其类中实现快速的 toString 方法，以便于在日志输出时仅输出这个对象类名和 hashCode</p>
<p>预防空指针:不要在日志中调用对象的方法获取值，除非确保该对象肯定不为 null，否则很有可能会因为日志的问题而导致应用产生空指针异常。 </p>
<h3 id="2-6-11-异常堆栈"><a href="#2-6-11-异常堆栈" class="headerlink" title="2.6.11 异常堆栈"></a><strong>2.6.11 异常堆栈</strong></h3><p>异常堆栈一般会出现在 ERROR 或者 WARN 级别的日志中，异常堆栈含有方法调用链的系统，以及异常产生的根源。异常堆栈的日志属于上一行日志的，在日志收集时需要将其划至上一行中。</p>
<h2 id="2-7-最佳实践"><a href="#2-7-最佳实践" class="headerlink" title="2.7 最佳实践"></a><strong>2.7 最佳实践</strong></h2><h3 id="2-7-1-日志格式"><a href="#2-7-1-日志格式" class="headerlink" title="2.7.1 日志格式"></a><strong>2.7.1 日志格式</strong></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-12-01 00:00:00.000|pid|log-level|[svc-name,trace-id,span-id,user-id,biz-id]|thread-name|package-name.class-name : log message</span><br></pre></td></tr></tbody></table></figure></div>

<ul>
<li>时间</li>
<li>pid，pid</li>
<li>log-level，日志级别</li>
<li>svc-name，应用名称</li>
<li>trace-id，调用链标识</li>
<li>span-id，调用层级标识</li>
<li>user-id，用户标识</li>
<li>biz-id，业务标识</li>
<li>thread-name，线程名称</li>
<li>package-name.class-name，日志记录器名称</li>
<li>log message，日志消息体</li>
</ul>
<h3 id="2-7-2-日志模块扩展"><a href="#2-7-2-日志模块扩展" class="headerlink" title="2.7.2 日志模块扩展"></a><strong>2.7.2 日志模块扩展</strong></h3><p>日志模块是基于以下技术点做扩展的。</p>
<ul>
<li>Slf4j MDC 实现原理（暂不开展详解，如有兴趣私下沟通）</li>
<li>Opentracing Scope 原理（暂不开展详解，如有兴趣私下沟通）</li>
</ul>
<p>在每个 tracing 链路中，将 Opentracing Scope 中的上下文信息放置 MDC 中，根据 Spring Boot Logging 扩展接口扩展的取值逻辑 <strong>logging.pattern.level</strong> 的取值逻辑。</p>
<p>相关源码参考：</p>
<p>Spring Cloud Sleuth：</p>
<p><a href="https://github.com/spring-cloud/spring-cloud-sleuth/blob/master/spring-cloud-sleuth-core/src/main/java/org/springframework/cloud/sleuth/autoconfig/TraceEnvironmentPostProcessor.java" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-sleuth/blob/master/spring-cloud-sleuth-core/src/main/java/org/springframework/cloud/sleuth/autoconfig/TraceEnvironmentPostProcessor.java</a></p>
<p><a href="https://github.com/spring-cloud/spring-cloud-sleuth/blob/master/spring-cloud-sleuth-core/src/main/java/org/springframework/cloud/sleuth/log/Slf4jCurrentTraceContext.java" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-sleuth/blob/master/spring-cloud-sleuth-core/src/main/java/org/springframework/cloud/sleuth/log/Slf4jCurrentTraceContext.java</a></p>
<p>修改 logback 配置文件中每个 appender 的 pattern 为以下默认值即可实现标准化。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}}|${PID:- }|%level|${LOG_LEVEL_PATTERN:-%5p}|%t|%-40.40logger{39}: %msg%n</span><br></pre></td></tr></tbody></table></figure></div>

<p>logback.xml 节选</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><configuration><property name="LOG_PATH" < span><br><span class="line">          value="${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}}"/></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><springproperty scope="context" name="APP_NAME" < span><br><span class="line">                source="spring.application.name" defaultValue="spring-boot-fusion"/></span><br><span class="line"><!-- 全局统一 pattern --></span><br><span class="line"><property name="LOG_PATTERN" < span><br><span class="line">          value="%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}}|${PID:- }|%level|${LOG_LEVEL_PATTERN:-%5p}|%t|%-40.40logger{39}: %msg%n"/></span><br><span class="line"><!-- 输出模式 file,滚动记录文件，先将日志文件指定到文件，当符合某个条件时，将日志记录到其他文件 --></span><br><span class="line"><appender name="fileInfo" class="ch.qos.logback.core.rolling.RollingFileAppender"></appender></span><br><span class="line">    <!--被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值。--></span><br><span class="line">    <file>${LOG_PATH}/${APP_NAME}-info.log</file></span><br><span class="line">    <!--滚动策略  基于时间的分包策略 --></span><br><span class="line">    <rollingpolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"></rollingpolicy></span><br><span class="line">        <!-- yyyy-MM-dd 时间策略则为一天一个文件 --></span><br><span class="line">        <filenamepattern>${LOG_PATH}/${APP_NAME}-info.%d{yyyy-MM-dd-HH}.%i.log</filenamepattern></span><br><span class="line">        <!--日志文件保留小时数--></span><br><span class="line">        <maxhistory>48</maxhistory></span><br><span class="line">        <maxfilesize>1GB</maxfilesize></span><br><span class="line">        <totalsizecap>20GB</totalsizecap></span><br><span class="line">    </span><br><span class="line">    <!--  layout 负责把事件转换成字符串，格式化的日志信息的输出 --></span><br><span class="line">    <layout class="ch.qos.logback.classic.PatternLayout"></layout></span><br><span class="line">        <pattern>${LOG_PATTERN}</pattern></span><br><span class="line">    </span><br><span class="line">    <!--级别过滤器，根据日志级别进行过滤。如果日志级别等于配置级别，过滤器会根据onMath 和 onMismatch接收或拒绝日志--></span><br><span class="line">    <filter class="ch.qos.logback.classic.filter.LevelFilter"></filter></span><br><span class="line">        <!--设置过滤级别--></span><br><span class="line">        <level>INFO</level></span><br><span class="line">        <!--用于配置符合过滤条件的操作--></span><br><span class="line">        <onmatch>ACCEPT</onmatch></span><br><span class="line">        <!--用于配置不符合过滤条件的操作--></span><br><span class="line">        <onmismatch>DENY</onmismatch></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span></property></span></springproperty></span></property></configuration></span><br></pre></td></tr></tbody></table></figure></div>



<p>代码使用示例：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public Result<pagingobject<simpleresponse>> page(@RequestParam(value = "page-num", defaultValue = "1") int pageNum,</pagingobject<simpleresponse></span><br><span class="line">                                                 @RequestParam(value = "page-size", defaultValue = "10") int pageSize) {</span><br><span class="line">    LogStandardUtils.putUserId("userId123");</span><br><span class="line">    LogStandardUtils.putBizId("bizId321");</span><br><span class="line">    producerService.sendMsg("xxx");</span><br><span class="line">    simpleClient.page(pageNum, pageSize);</span><br><span class="line">    return new Result<>(simpleService.page(pageNum, pageSize));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>



<p>日志记录</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">2019-12-04 16:29:08.223|43546|INFO|[example-server-book-service,ac613cff04bac8b1,4a9adc10fdf0eb5,userId123,bizId321]|XNIO-1 task-4|c.n.u.concurrent.ShutdownEnabledTimer   : Shutdown hook installed for: NFLoadBalancer-PingTimer-example-server-order-service</span><br><span class="line">2019-12-04 16:29:08.224|43546|INFO|[example-server-book-service,ac613cff04bac8b1,4a9adc10fdf0eb5,userId123,bizId321]|XNIO-1 task-4|c.netflix.loadbalancer.BaseLoadBalancer : Client: example-server-order-service instantiated a LoadBalancer: DynamicServerListLoadBalancer:{NFLoadBalancer:name=example-server-order-service,current list of Servers=[],Load balancer stats=Zone stats: {},Server stats: []}ServerList:null</span><br><span class="line">2019-12-04 16:29:08.234|43546|INFO|[example-server-book-service,ac613cff04bac8b1,4a9adc10fdf0eb5,userId123,bizId321]|XNIO-1 task-4|c.n.l.DynamicServerListLoadBalancer     : Using serverListUpdater PollingServerListUpdater</span><br><span class="line">2019-12-04 16:29:08.247|43546|INFO|[example-server-book-service,ac613cff04bac8b1,4a9adc10fdf0eb5,userId123,bizId321]|XNIO-1 task-4|c.n.l.DynamicServerListLoadBalancer     : DynamicServerListLoadBalancer for client example-server-order-service initialized: DynamicServerListLoadBalancer:{NFLoadBalancer:name=example-server-order-service,current list of Servers=[],Load balancer stats=Zone stats: {},Server stats: []}ServerList:ConsulServerList{serviceId='example-server-order-service', tag=null}</span><br><span class="line">2019-12-04 16:29:08.329|43546|WARN|[example-server-book-service,ac613cff04bac8b1,4a9adc10fdf0eb5,userId123,bizId321]|XNIO-1 task-4|c.p.f.l.ctl.common.rule.StrategyRule    : No up servers available from load balancer: DynamicServerListLoadBalancer:{NFLoadBalancer:name=example-server-order-service,current list of Servers=[],Load balancer stats=Zone stats: {},Server stats: []}ServerList:ConsulServerList{serviceId='example-server-order-service', tag=null}</span><br><span class="line">2019-12-04 16:29:08.334|43546|WARN|[example-server-book-service,ac613cff04bac8b1,4a9adc10fdf0eb5,userId123,bizId321]|XNIO-1 task-4|c.p.f.l.ctl.common.rule.StrategyRule    : No up servers available from load balancer: DynamicServerListLoadBalancer:{NFLoadBalancer:name=example-server-order-service,current list of Servers=[],Load balancer stats=Zone stats: {},Server stats: []}ServerList:ConsulServerList{serviceId='example-server-order-service', tag=null}</span><br><span class="line">2019-12-04 16:29:08.342|43546|ERROR|[example-server-book-service,ac613cff04bac8b1,4a9adc10fdf0eb5,userId123,bizId321]|XNIO-1 task-4|c.p.f.w.c.advice.ExceptionHandlerAdvice : 当前程序进入到异常捕获器，出错的 url 为：[ http://127.0.0.1:10011/simples ]，出错的参数为：[ {"querystring":"{}","payload":""} ]</span><br><span class="line">java.lang.RuntimeException: com.netflix.client.ClientException: Load balancer does not have available server for client: example-server-order-service</span><br></pre></td></tr></tbody></table></figure></div>

<h2 id="3-1-SLS-阿里云日志服务"><a href="#3-1-SLS-阿里云日志服务" class="headerlink" title="3.1 SLS 阿里云日志服务"></a><strong>3.1 SLS 阿里云日志服务</strong></h2><p>阿里云日志服务（简称 SLS）是针对日志类数据的一站式服务，在阿里巴巴集团经历大量大数据场景锤炼而成。您无需开发就能快捷完成日志数据采集、消费、投递以及查询分析等功能，提升运维、运营效率，建立 DT 时代海量日志处理能力。</p>
<h3 id="project"><a href="#project" class="headerlink" title="project"></a>project</h3><blockquote>
<p>项目、管理日志基础单元，服务日志建议一个环境建为一个 Project，这样日志记录是整体一个闭环，日志记录随整个环境内的服务调用产生。</p>
</blockquote>
<h3 id="logstore"><a href="#logstore" class="headerlink" title="logstore"></a>logstore</h3><blockquote>
<p>日志库，日志库建议按照日志类型分为不同的，如特定格式的 access 日志，以及 info / warn / error 日志，特定格式可以配置更为方面的索引以及告警设置。</p>
</blockquote>
<p>注意：请勿按照应用服务区分为不同的 logstore，在微服务架构中，一次请求交叉了多个应用服务，日志是散落在各个应用服务中的，按照服务区分 logstore，需要开发同学十分了解应用运行状况和调用拓扑图，这点往往是不具备的。</p>
<h3 id="实时采集与消费"><a href="#实时采集与消费" class="headerlink" title="实时采集与消费"></a>实时采集与消费</h3><p>功能：</p>
<ul>
<li>通过ECS、容器、移动端、开源软件、JS等接入实时日志数据（例如Metric、Event、BinLog、TextLog、Click等）。</li>
<li>提供实时消费接口，与实时计算及服务对接。</li>
</ul>
<p>用途：数据清洗（ETL）、流计算（Stream Compute）、监控与报警、 机器学习与迭代计算。</p>
<p>​    <a href="https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39z8QOFjBe0kVPaC7OgPDTxPcAnrYDCm5TIP4U5AINkicfa5icaR8WjLOBMCsVNMuzFZIcRVgkYpdicAQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" target="_blank" rel="noopener" data-fancybox="group" data-caption="img" class="fancybox"><img alt="img" title="img" data-src="https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39z8QOFjBe0kVPaC7OgPDTxPcAnrYDCm5TIP4U5AINkicfa5icaR8WjLOBMCsVNMuzFZIcRVgkYpdicAQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" class="lazyload"></a>   </p>
<h3 id="查询分析"><a href="#查询分析" class="headerlink" title="查询分析"></a>查询分析</h3><p>实时索引、查询分析数据。</p>
<ul>
<li>查询：关键词、模糊、上下文、范围。</li>
<li>统计：SQL聚合等丰富查询手段。</li>
<li>可视化：Dashboard + 报表功能。</li>
<li>对接：Grafana、JDBC/SQL92。</li>
</ul>
<p>用途：DevOps / 线上运维，日志实时数据分析，安全诊断与分析，运营与客服系统。</p>
<p>​    <a href="https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39z8QOFjBe0kVPaC7OgPDTxP2FzibNf6M2TAo5qL7tGyDNo19CFM9LccLCbQZEibn5zNHmlL4ErMltWw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" target="_blank" rel="noopener" data-fancybox="group" data-caption="img" class="fancybox"><img alt="img" title="img" data-src="https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39z8QOFjBe0kVPaC7OgPDTxP2FzibNf6M2TAo5qL7tGyDNo19CFM9LccLCbQZEibn5zNHmlL4ErMltWw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" class="lazyload"></a>   </p>
<h3 id="消费投递"><a href="#消费投递" class="headerlink" title="消费投递"></a>消费投递</h3><p>稳定可靠的日志投递。将日志中枢数据投递至存储类服务进行存储。支持压缩、自定义Partition、以及行列等各种存储方式。</p>
<p>用途：数据仓库 + 数据分析、审计、推荐系统与用户画像。</p>
<p>​    <a href="https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39z8QOFjBe0kVPaC7OgPDTxPqVBwqPWa3LzOFG84jmo5zyfX0YO4QFCL2mvxaJW1sI2ckz1KIygYRw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" target="_blank" rel="noopener" data-fancybox="group" data-caption="img" class="fancybox"><img alt="img" title="img" data-src="https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39z8QOFjBe0kVPaC7OgPDTxPqVBwqPWa3LzOFG84jmo5zyfX0YO4QFCL2mvxaJW1sI2ckz1KIygYRw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" class="lazyload"></a>   </p>
<h3 id="告警"><a href="#告警" class="headerlink" title="告警"></a>告警</h3><p>日志服务的告警功能基于仪表盘中的查询图表实现。在日志服务控制台<strong>查询页面</strong>或<strong>仪表盘页面</strong>设置告警规则，并指定告警规则的配置、检查条件和通知方式。设置告警后，日志服务定期对仪表盘的查询结果进行检查，检查结果满足预设条件时发送告警通知，实现实时的服务状态监控。</p>
<h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a><strong>最佳实践</strong></h3><p>阿里云的日志服务功能相当强大，想用好日志服务可以参考：</p>
<p><a href="https://help.aliyun.com/document_detail/29090.html?spm=a2c4g.11186623.6.1079.4edd3aabvs50OW" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/29090.html?spm=a2c4g.11186623.6.1079.4edd3aabvs50OW</a></p>
<h2 id="3-2-ELK-通用日志解决方案"><a href="#3-2-ELK-通用日志解决方案" class="headerlink" title="3.2 ELK 通用日志解决方案"></a><strong>3.2 ELK 通用日志解决方案</strong></h2><p>ELK 是 Elasticsearch、Logstash、Kibana 三大开源框架首字母大写简称。市面上也被成为 Elastic Stack。其中 Elasticsearch 是一个基于 Lucene、分布式、通过 Restful 方式进行交互的近实时搜索平台框架。像类似百度、谷歌这种大数据全文搜索引擎的场景都可以使用 Elasticsearch 作为底层支持框架，可见 Elasticsearch 提供的搜索能力确实强大，市面上很多时候我们简称 Elasticsearch 为 es。Logstash 是 ELK 的中央数据流引擎，用于从不同目标（文件/数据存储/MQ）收集的不同格式数据，经过过滤后支持输出到不同目的地（文件/ MQ / Redis / Elasticsearch / Kafka 等）。Kibana 可以将 Elasticsearch 的数据通过友好的页面展示出来，提供实时分析的功能。</p>
<h1 id="4-实践说明"><a href="#4-实践说明" class="headerlink" title="4 实践说明"></a><strong>4 实践说明</strong></h1><h2 id="普通格式日志"><a href="#普通格式日志" class="headerlink" title="普通格式日志"></a>普通格式日志</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-11-26 15:01:03.332|1543|INFO|[example-server-book-service,28f019d57b8336ab,630697c7f34ca4fa,105,45982043|XNIO-1 task-42]|c.p.f.w.pay.PayServiceImpl     : order is paying with userId: 105 and orderId: 45982043</span><br></pre></td></tr></tbody></table></figure></div>

<p>普通日志前缀是固定的，可以固定分词索引，方便更快的查询分析。</p>
<h2 id="特定格式日志"><a href="#特定格式日志" class="headerlink" title="特定格式日志"></a>特定格式日志</h2><p>以 access 日志为例</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2019-11-26 15:01:03.332|1543|INFO|[example-server-book-service,28f019d57b8336ab,630697c7f34ca4fa,105,45982043|XNIO-1 task-42]|c.p.f.w.logging.AccessLoggingFilter     :</span><br><span class="line">> url: http://liweichao.com:10011/actuator/health</span><br><span class="line">> http-method: GET</span><br><span class="line">> request-header: [Accept:"text/plain, text/*, */*", Connection:"close", User-Agent:"Consul Health Check", Host:"liweichao.com:10011", Accept-Encoding:"gzip"]</span><br><span class="line">> request-time: 2019-11-26 15:01:03.309</span><br><span class="line">> querystring: -</span><br><span class="line">> payload: -</span><br><span class="line">> extra-param: -</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">< response-time: 2019-11-26 15:01:03.332</span><br><span class="line">< take-time: 23</span><br><span class="line">< http-status: 200</span><br><span class="line">< response-header: [content-type:"application/vnd.spring-boot.actuator.v2+json;charset=UTF-8", content-size:"15"]</span><br><span class="line">< response-data: {"status":"UP"}</span><br></pre></td></tr></tbody></table></figure></div>

<p>特定格式日志可按格式创建索引更方便聚焦查询分析和告警，如根据 take-time，http-status，biz-code 等值。</p>
<h2 id="引入相关maven坐标"><a href="#引入相关maven坐标" class="headerlink" title="引入相关maven坐标"></a>引入相关maven坐标</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><!--starter坐标--></span></span><br><span class="line"><span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">groupId</span>></span>org.springframework.boot<span class="tag"><!--<span class="name"-->groupId</span>></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>spring-boot-starter-web<span class="tag"><!--<span class="name"-->artifactId</span>></span><br><span class="line"><span class="tag"><!--<span class="name"-->dependency</span>></span><br><span class="line"></span><br><span class="line"><span class="comment"><!--janino--></span></span><br><span class="line"><span class="comment"><!--若用到了logback的if标签的condition表达式，就需要该坐标--></span></span><br><span class="line"><span class="comment"><!--否则会抛出该错误：ERROR in ch.qos.logback.core.joran.conditional.IfAction - Could not find Janino library on the class path. Skipping conditional processing.--></span></span><br><span class="line"><span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">groupId</span>></span>org.codehaus.janino<span class="tag"><!--<span class="name"-->groupId</span>></span><br><span class="line">    <span class="tag"><<span class="name">artifactId</span>></span>janino<span class="tag"><!--<span class="name"-->artifactId</span>></span><br><span class="line">    <span class="tag"><<span class="name">version</span>></span>2.6.1<span class="tag"><!--<span class="name"-->version</span>></span><br><span class="line"><span class="tag"><!--<span class="name"-->dependency</span>></span><br></pre></td></tr></tbody></table></figure></div>



<h2 id="配置参考"><a href="#配置参考" class="headerlink" title="配置参考"></a>配置参考</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><!--?xml version="1.0" encoding="UTF-8"?--></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><!--</span></span><br><span class="line"><span class="comment">   说明：</span></span><br><span class="line"><span class="comment">   1、日志级别及文件</span></span><br><span class="line"><span class="comment">       日志记录采用分级记录，级别与日志文件名相对应，不同级别的日志信息记录到不同的日志文件中</span></span><br><span class="line"><span class="comment">       例如：error级别记录到xxx-error-xxx.log（该文件为当前记录的日志文件），而xxx-error-xxx.x.log为归档日志，</span></span><br><span class="line"><span class="comment">       日志文件按日期记录，同一天内，若日志文件大小等于或大于2M，则按0、1、2...顺序分别命名</span></span><br><span class="line"><span class="comment">       例如xxx-error-2013-12-21.0.log</span></span><br><span class="line"><span class="comment">       其它级别的日志也是如此。</span></span><br><span class="line"><span class="comment">   2、文件路径</span></span><br><span class="line"><span class="comment">       若本地开发，以绝对路径指定，如：/Users/zhangboqing/Downloads/logs。</span></span><br><span class="line"><span class="comment">       若部署到服务器，则各个服务器约定一个固定的日志路径如/data/home/logs/【项目名】/</span></span><br><span class="line"><span class="comment">   3、Appender</span></span><br><span class="line"><span class="comment">       FILE-ALL对应所有级别，文件名以xxx-all-xxx.log形式命名</span></span><br><span class="line"><span class="comment">       FILE-ERROR对应error级别，文件名以xxx-error-xxx.log形式命名</span></span><br><span class="line"><span class="comment">       FILE-WARN对应warn级别，文件名以xxx-warn-xxx.log形式命名</span></span><br><span class="line"><span class="comment">       FILE-INFO对应info级别，文件名以xxx-info-xxx.log形式命名</span></span><br><span class="line"><span class="comment">       FILE-DEBUG对应debug级别，文件名以xxx-debug-xxx.log形式命名</span></span><br><span class="line"><span class="comment">       STDOUT将日志信息输出到控制上，为方便开发测试使用</span></span><br><span class="line"><span class="comment">--></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"><!-- 一、根节点<configuration>，包含下面三个属性--></span></span><br><span class="line"><span class="comment"><!--1.scan: 当此属性设置为true时，配置文件如果发生改变，将会被重新加载，默认值为true--></span></span><br><span class="line"><span class="comment"><!--2.scanPeriod: 设置监测配置文件是否有修改的时间间隔，如果没有给出时间单位，默认单位是毫秒。当scan为true时，此属性生效。默认的时间间隔为1分钟。--></span></span><br><span class="line"><span class="comment"><!--3.de<span class="doctag">bug:</span> 当此属性设置为true时，将打印出logback内部日志信息，实时查看logback运行状态。默认值为false。--></span></span><br><span class="line"><span class="tag"><<span class="name">configuration</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns</span>=<span class="string">"http://ch.qos.logback/xml/ns/logback"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://ch.qos.logback/xml/ns/logback https://raw.githubusercontent.com/enricopulatzo/logback-XSD/master/src/main/xsd/logback.xsd"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">scan</span>=<span class="string">"true"</span>></span></span><br><span class="line">    <span class="comment"><!--注册转换器，颜色转化器--></span></span><br><span class="line">    <span class="tag"><<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">"clr"</span> <span class="attr">converterClass</span>=<span class="string">"org.springframework.boot.logging.logback.ColorConverter"</span>/></span></span><br><span class="line">    <span class="tag"><<span class="name">conversionRule</span> <span class="attr">conversionWord</span>=<span class="string">"wex"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">converterClass</span>=<span class="string">"org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter"</span>/></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- 二、子节点<contextName>：用来设置上下文名称，每个logger都关联到logger上下文，默认上下文名称为default。但可以使用<contextName>设置成其他名字，用于区分不同应用程序的记录。一旦设置，不能修改。--></span></span><br><span class="line">    <span class="tag"><<span class="name">contextName</span>></span>springboot-base-frame<span class="tag"><!--<span class="name"-->contextName</span>></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- 三、子节点<property> --></span></span><br><span class="line">    <span class="comment"><!--子节点<property name="" value=""> ：用来定义变量值，它有两个属性name和value，通过<property>定义的值会被插入到logger上下文中，可以使“${}”来使用变量。--></span></span><br><span class="line">    <span class="comment"><!--子节点<property resource=""/> ：用来引入外部属性文件，可以使“${}”来使用变量。--></span></span><br><span class="line">    <span class="tag"><<span class="name">property</span> <span class="attr">resource</span>=<span class="string">"logback.properties"</span>/></span></span><br><span class="line">    <span class="comment"><!--日志输出格式--></span></span><br><span class="line">    <span class="comment"><!--控制台-彩色--></span></span><br><span class="line">    <span class="comment"><!--<property name="CONSOLE_LOG_PATTERN" value="%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}) %boldYellow([%thread]) %highlight(%-5level) %boldGreen(%logger{50}) - %msg%n" />--></span></span><br><span class="line">    <span class="comment"><!--文件-黑白--></span></span><br><span class="line">    <span class="comment"><!--<property name="FILE_LOG_PATTERN" value="%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n" />--></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- 四、子节点<appender>：负责写日志的组件，它有两个必要属性name和class。name指定appender名称，class指定appender的全限定名 --></span></span><br><span class="line">    <span class="comment"><!--4.1 class为ch.qos.logback.core.ConsoleAppender 把日志输出到控制台--></span></span><br><span class="line">    <span class="comment"><!--4.2 class为ch.qos.logback.core.FileAppender 把日志添加到文件--></span></span><br><span class="line">    <span class="comment"><!--4.3 class为ch.qos.logback.core.rolling.RollingFileAppender 滚动记录文件，先将日志记录到指定文件，当符合某个条件时，将日志记录到其他文件--></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- 控制台输出 --></span></span><br><span class="line">    <span class="comment"><!--<if condition='property("ifOpenConsol").contains("true")'>--></span></span><br><span class="line">    <span class="tag"><<span class="name">if</span> <span class="attr">condition</span>=<span class="string">'p("ifOpenConsol").contains("true")'</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">then</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"STDOUT"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.ConsoleAppender"</span>></span></span><br><span class="line">                <span class="tag"><<span class="name">encoder</span>></span></span><br><span class="line">                    <span class="comment"><!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--></span></span><br><span class="line">                    <span class="tag"><<span class="name">pattern</span>></span>${CONSOLE_LOG_PATTERN}<span class="tag"><!--<span class="name"-->pattern</span>></span><br><span class="line">                    <span class="tag"><<span class="name">charset</span>></span>${logback.charset}<span class="tag"><!--<span class="name"-->charset</span>></span><br><span class="line">                <span class="tag"><!--<span class="name"-->encoder</span>></span><br><span class="line">                <span class="comment"><!--字符串 System.out 或者 System.err ，默认 System.out --></span></span><br><span class="line">                <span class="tag"><<span class="name">target</span>></span>System.out<span class="tag"><!--<span class="name"-->target</span>></span><br><span class="line">            <span class="tag"><!--<span class="name"-->appender</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->then</span>></span><br><span class="line">    <span class="tag"><!--<span class="name"-->if</span>></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!--日志记录器，日期滚动记录--></span></span><br><span class="line">    <span class="comment"><!-- 按照每天生成日志文件 --></span></span><br><span class="line">    <span class="comment"><!-- INFO --></span></span><br><span class="line">    <span class="tag"><<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"FILE-INFO"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class="line">        <span class="comment"><!--日志文件的路径及文件名--></span></span><br><span class="line">        <span class="comment"><!--被写入的文件名，可以是相对目录，也可以是绝对目录，如果上级目录不存在会自动创建，没有默认值--></span></span><br><span class="line">        <span class="tag"><<span class="name">file</span>></span>${logback.dir}/${logback.info.filename}.log<span class="tag"><!--<span class="name"-->file</span>></span><br><span class="line">        <span class="comment"><!-- 如果 true，事件被追加到现存文件尾部。如果 false，清空现存文件.默认为 true --></span></span><br><span class="line">        <span class="tag"><<span class="name">append</span>></span>true<span class="tag"><!--<span class="name"-->append</span>></span><br><span class="line">        <span class="comment"><!--临界值过滤器，过滤掉低于指定临界值的日志。当日志级别等于或高于临界值时，过滤器返回NEUTRAL；当日志级别低于临界值时，日志会被拒绝--></span></span><br><span class="line">        <span class="comment"><!-- 此日志文件只记录INFO级别的 --></span></span><br><span class="line">        <span class="tag"><<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.ThresholdFilter"</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">level</span>></span>INFO<span class="tag"><!--<span class="name"-->level</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->filter</span>></span><br><span class="line">        <span class="comment"><!--当发生滚动时，决定 RollingFileAppender 的行为--></span></span><br><span class="line">        <span class="comment"><!--日志记录器的滚动策略，按日期，按大小记录,涉及文件移动和重命名--></span></span><br><span class="line">        <span class="tag"><<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>></span></span><br><span class="line">            <span class="comment"><!-- 归档的日志文件的路径，例如今天是2018-09-21日志，当前写的日志文件路径为file节点指定，可以将此文件与file指定文件路径设置为不同路径，从而将当前日志文件或归档日志文件置不同的目录。</span></span><br><span class="line"><span class="comment">            而2018-09-21的归档日志文件在由fileNamePattern指定。%d{yyyy-MM-dd}指定日期格式，%i指定索引 --></span></span><br><span class="line">            <span class="comment"><!--即file和fileNamePattern同时制定，当天日志名由file决定，前一天的文件名将自动改为fileNamePattern的值--></span></span><br><span class="line">            <span class="comment"><!-- 若要加一层时间目录 <fileNamePattern>${logback.dir}/%d{yyyy-MM-dd,aux}/${logback.info.filename}.%i.log.gz</fileNamePattern>--></span></span><br><span class="line">            <span class="tag"><<span class="name">fileNamePattern</span>></span>${logback.dir}/${logback.info.filename}.%d{yyyy-MM-dd}.%i.log<span class="tag"><!--<span class="name"-->fileNamePattern</span>></span><br><span class="line">            <span class="comment"><!--控制被保留的归档文件的最大数量，超出数量就删除旧文件--></span></span><br><span class="line">            <span class="comment"><!--日志文件保留天数 --></span></span><br><span class="line">            <span class="tag"><<span class="name">maxHistory</span>></span>${logback.maxhistory}<span class="tag"><!--<span class="name"-->maxHistory</span>></span>|<br><span class="line">            <span class="comment"><!--指定文件的大小--></span></span><br><span class="line">            <span class="tag"><<span class="name">maxFileSize</span>></span>${logback.maxfilesize}<span class="tag"><!--<span class="name"-->maxFileSize</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->rollingPolicy</span>></span><br><span class="line">        <span class="comment"><!--负责两件事，一是把日志信息转换成字节数组，二是把字节数组写入到输出流--></span></span><br><span class="line">        <span class="comment"><!-- 日志文件的格式 --></span></span><br><span class="line">        <span class="tag"><<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.encoder.PatternLayoutEncoder"</span>></span></span><br><span class="line">            <span class="comment"><!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--></span></span><br><span class="line">            <span class="tag"><<span class="name">pattern</span>></span>${FILE_LOG_PATTERN}<span class="tag"><!--<span class="name"-->pattern</span>></span><br><span class="line">            <span class="comment"><!--日志字符编码格式--></span></span><br><span class="line">            <span class="tag"><<span class="name">charset</span>></span>${logback.charset}<span class="tag"><!--<span class="name"-->charset</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->encoder</span>></span><br><span class="line">    <span class="tag"><!--<span class="name"-->appender</span>></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- ALL --></span></span><br><span class="line">    <span class="tag"><<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"FILE-ALL"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">file</span>></span>${logback.dir}/${logback.all.filename}.log<span class="tag"><!--<span class="name"-->file</span>></span><br><span class="line">        <span class="tag"><<span class="name">append</span>></span>true<span class="tag"><!--<span class="name"-->append</span>></span><br><span class="line">        <span class="tag"><<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">fileNamePattern</span>></span>${logback.dir}/${logback.all.filename}.%d{yyyy-MM-dd}.%i.log.gz<span class="tag"><!--<span class="name"-->fileNamePattern</span>></span><br><span class="line">            <span class="tag"><<span class="name">maxHistory</span>></span>${logback.maxhistory}<span class="tag"><!--<span class="name"-->maxHistory</span>></span><br><span class="line">            <span class="tag"><<span class="name">maxFileSize</span>></span>${logback.maxfilesize}<span class="tag"><!--<span class="name"-->maxFileSize</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->rollingPolicy</span>></span><br><span class="line">        <span class="tag"><<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.encoder.PatternLayoutEncoder"</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">pattern</span>></span>${FILE_LOG_PATTERN}<span class="tag"><!--<span class="name"-->pattern</span>></span><br><span class="line">            <span class="tag"><<span class="name">charset</span>></span>${logback.charset}<span class="tag"><!--<span class="name"-->charset</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->encoder</span>></span><br><span class="line">    <span class="tag"><!--<span class="name"-->appender</span>></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- ERROR --></span></span><br><span class="line">    <span class="tag"><<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"FILE-ERROR"</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.RollingFileAppender"</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">file</span>></span>${logback.dir}/${logback.error.filename}.log<span class="tag"><!--<span class="name"-->file</span>></span><br><span class="line">        <span class="tag"><<span class="name">append</span>></span>true<span class="tag"><!--<span class="name"-->append</span>></span><br><span class="line">        <span class="tag"><<span class="name">filter</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.filter.ThresholdFilter"</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">level</span>></span>ERROR<span class="tag"><!--<span class="name"-->level</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->filter</span>></span><br><span class="line">        <span class="tag"><<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy"</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">fileNamePattern</span>></span>${logback.dir}/${logback.error.filename}.%d{yyyy-MM-dd}.%i.log.gz<span class="tag"><!--<span class="name"-->fileNamePattern</span>></span><br><span class="line">            <span class="tag"><<span class="name">maxHistory</span>></span>${logback.maxhistory}<span class="tag"><!--<span class="name"-->maxHistory</span>></span><br><span class="line">            <span class="tag"><<span class="name">maxFileSize</span>></span>${logback.maxfilesize}<span class="tag"><!--<span class="name"-->maxFileSize</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->rollingPolicy</span>></span><br><span class="line">        <span class="tag"><<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">"ch.qos.logback.classic.encoder.PatternLayoutEncoder"</span>></span></span><br><span class="line">            <span class="tag"><<span class="name">pattern</span>></span>${FILE_LOG_PATTERN}<span class="tag"><!--<span class="name"-->pattern</span>></span><br><span class="line">            <span class="tag"><<span class="name">charset</span>></span>${logback.charset}<span class="tag"><!--<span class="name"-->charset</span>></span><br><span class="line">        <span class="tag"><!--<span class="name"-->encoder</span>></span><br><span class="line">    <span class="tag"><!--<span class="name"-->appender</span>></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- 五、子节点<logger>：用来设置某一个包或具体的某一个类的日志打印级别、以及指定<appender>。<loger>仅有一个name属性，一个可选的level和一个可选的addtivity属性。可以包含零个或多个<appender-ref>元素，标识这个appender将会添加到这个loger--></span></span><br><span class="line">    <span class="comment"><!-- 六、子节点<root>:它也是<logger>元素，但是它是根logger,是所有<logger>的上级。只有一个level属性，因为name已经被命名为"root",且已经是最上级了。--></span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><!-- 生产环境下，将此级别配置为适合的级别，以免日志文件太多或影响程序性能 --></span></span><br><span class="line">    <span class="comment"><!--这里改level--></span></span><br><span class="line">    <span class="tag"><<span class="name">root</span> <span class="attr">level</span>=<span class="string">"${logback.level}"</span>></span></span><br><span class="line">        <span class="tag"><<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"STDOUT"</span>/></span></span><br><span class="line">        <span class="tag"><<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"FILE-ALL"</span>/></span></span><br><span class="line">        <span class="tag"><<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"FILE-INFO"</span>/></span></span><br><span class="line">        <span class="tag"><<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"FILE-ERROR"</span>/></span></span><br><span class="line">    <span class="tag"><!--<span class="name"-->root</span>></span><br><span class="line"></span><br><span class="line"><span class="tag"><!--<span class="name"-->configuration</span>></span><br></pre></td></tr></tbody></table></figure></div>



<h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><ul>
<li>Java日志记录最佳实践 ：<a href="https://www.jianshu.com/p/546e9aace657" target="_blank" rel="noopener">https://www.jianshu.com/p/546e9aace657</a>)</li>
<li>别在 Java 代码里乱打日志了，这才是打印日志的正确姿势！：<a href="https://mp.weixin.qq.com/s/hJvkRlt9xQbWhYy1G7ZDsw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/hJvkRlt9xQbWhYy1G7ZDsw</a></li>
<li>阿里云日志服务：<a href="https://help.aliyun.com/product/28958.html?spm=a2c4g.11186623.3.1.7cfd735dv8i1pB" target="_blank" rel="noopener">https://help.aliyun.com/product/28958.html?spm=a2c4g.11186623.3.1.7cfd735dv8i1pB</a></li>
<li>Spring Boot Logging：<a href="https://docs.spring.io/spring-boot/docs/2.2.1.RELEASE/reference/html/spring-boot-features.html#boot-features-logging" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/2.2.1.RELEASE/reference/html/spring-boot-features.html#boot-features-logging</a></li>
<li>Spring Cloud Sleuth：<a href="https://github.com/spring-cloud/spring-cloud-sleuth" target="_blank" rel="noopener">https://github.com/spring-cloud/spring-cloud-sleuth</a></li>
<li>Opentracing：<a href="https://github.com/opentracing" target="_blank" rel="noopener">https://github.com/opentracing</a></li>
</ul>
<blockquote>
<p>文章来源于 <a href="https://mp.weixin.qq.com/s/UDVr13gBS-_VhsXn6FZQEg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/UDVr13gBS-_VhsXn6FZQEg</a></p>
</blockquote>
</body></html></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">calebzhao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://calebzhao.github.io/2020/01/10/Spring%20Boot%E4%B9%8Blogback%E6%97%A5%E5%BF%97%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">https://calebzhao.github.io/2020/01/10/Spring%20Boot%E4%B9%8Blogback%E6%97%A5%E5%BF%97%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://calebzhao.github.io">calebzhao的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/calebzhao/cdn/img/20191229151714.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/calebzhao/cdn/img/20191229152519.jpg" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2020/01/09/power%20designer%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>power designer日常使用</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = '昵称,邮箱,链接'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'HgchHaGng3F6hbefP0mcTaYh-gzGzoHsz',
  appKey:'j47kWakblNYEeDic8riu7flK',
  placeholder:'请留下你的足迹',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By calebzhao</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div><img src="https://api.travis-ci.com/calebzhao/calebzhao.github.io.svg?branch=hexo"></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/click_heart.js"></script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>